# Bç«™ç½‘ç»œè¯·æ±‚åŒ…åˆ†æä¸åŠŸèƒ½å¢å¼ºæŠ¥å‘Š

## ğŸ“ é¡¹ç›®æ¦‚è¿°

åŸºäºç”¨æˆ·æä¾›çš„Bç«™çœŸå®ç½‘ç»œè¯·æ±‚åŒ…ï¼Œæˆ‘ä»¬å¯¹MCPæœåŠ¡å™¨è¿›è¡Œäº†å…¨é¢çš„åˆ†æå’Œä¼˜åŒ–ï¼Œæ˜¾è‘—æå‡äº†åçˆ¬è™«èƒ½åŠ›å’ŒAPIæˆåŠŸç‡ã€‚

## ğŸ” è¯·æ±‚åŒ…åˆ†æç»“æœ

### åŸå§‹è¯·æ±‚ä¿¡æ¯
- **è¯·æ±‚ç±»å‹**: POSTåˆ°`data.bilibili.com/log/web`
- **æµè§ˆå™¨**: Microsoft Edge 139.0.0.0 (macOS)
- **è®¾å¤‡**: MacBook (åˆ†è¾¨ç‡1462x725)
- **Cookieæ•°é‡**: 22ä¸ªå®Œæ•´cookie

### å…³é”®å‘ç°
1. **çœŸå®æµè§ˆå™¨ç‰¹å¾**: Edgeæµè§ˆå™¨å®Œæ•´çš„User-Agentå­—ç¬¦ä¸²
2. **å®‰å…¨å¤´éƒ¨**: åŒ…å«æ‰€æœ‰ç°ä»£æµè§ˆå™¨å®‰å…¨ç‰¹å¾
3. **è®¾å¤‡æŒ‡çº¹**: å®Œæ•´çš„è®¾å¤‡å’Œæµè§ˆå™¨ç¯å¢ƒä¿¡æ¯
4. **ä¼šè¯ç®¡ç†**: å…¨å¥—Bç«™è®¤è¯å’Œä¼šè¯cookie

## âœ… å®Œæˆçš„ä¼˜åŒ–é¡¹ç›®

### 1. è¯·æ±‚å¤´å¢å¼º (å·²å®Œæˆ)
- âœ… æ›´æ–°ä¸ºçœŸå®Edgeæµè§ˆå™¨User-Agent
- âœ… æ·»åŠ å®Œæ•´çš„sec-ch-uaç³»åˆ—å¤´éƒ¨
- âœ… åŒ…å«æµè§ˆå™¨å¹³å°å’Œè®¾å¤‡ç‰¹å¾
- âœ… æ”¯æŒæœ€æ–°çš„å®‰å…¨åè®®

**æ›´æ–°å‰**:
```
"User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
```

**æ›´æ–°å**:
```
"User-Agent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/139.0.0.0 Safari/537.36 Edg/139.0.0.0"
"sec-ch-ua": '"Not;A=Brand";v="99", "Microsoft Edge";v="139", "Chromium";v="139"'
"sec-ch-ua-platform": '"macOS"'
```

### 2. Cookieé…ç½®å®Œå–„ (å·²å®Œæˆ)
- âœ… ä»22ä¸ªcookieä¸­æå–æ‰€æœ‰å…³é”®å­—æ®µ
- âœ… åŒ…å«æ ¸å¿ƒè®¤è¯cookie (SESSDATA, bili_jct)
- âœ… æ·»åŠ è®¾å¤‡æ ‡è¯†cookie (buvid3, buvid4, buvid_fp)
- âœ… å¢åŠ ä¼šè¯å’Œè¡Œä¸ºcookie (b_lsid, rpdid)

**æ–°å¢Cookieå­—æ®µ**:
- `DedeUserID__ckMd5`: ç”¨æˆ·IDæ ¡éªŒ
- `bili_ticket`: JWTä»¤ç‰Œ
- `browser_resolution`: æµè§ˆå™¨åˆ†è¾¨ç‡
- `theme-*`: ä¸»é¢˜é…ç½®
- `home_feed_column`: é¦–é¡µé…ç½®

### 3. åçˆ¬æªæ–½å®ç° (å·²å®Œæˆ)
- âœ… **è®¾å¤‡æŒ‡çº¹ç”Ÿæˆ**: æ¨¡æ‹ŸçœŸå®è®¾å¤‡ç¯å¢ƒ
- âœ… **éšæœºè¯·æ±‚å¤´**: åŠ¨æ€æ·»åŠ å¯é€‰å¤´éƒ¨
- âœ… **è¯·æ±‚é—´éš”æ§åˆ¶**: 1-3ç§’éšæœºé—´éš”
- âœ… **å‚æ•°å¢å¼º**: æ—¶é—´æˆ³å’ŒéšæœºID
- âœ… **è¿æ¥æ± ä¼˜åŒ–**: æé«˜è¿æ¥å¤ç”¨æ•ˆç‡

### 4. APIæ–¹æ³•å‡çº§ (å·²å®Œæˆ)
- âœ… `get_video_info`: æ·»åŠ è®¾å¤‡æŒ‡çº¹å’Œå¢å¼ºå¤´éƒ¨
- âœ… `get_user_info`: ä¼˜åŒ–è¯·æ±‚å‚æ•°
- âœ… å…¨å±€åº”ç”¨åçˆ¬æªæ–½
- âœ… æ–°å¢æµ‹è¯•å·¥å…· `test_enhanced_features`

## ğŸš€ æŠ€æœ¯åˆ›æ–°äº®ç‚¹

### 1. çœŸå®ç¯å¢ƒæ¨¡æ‹Ÿ
```python
def _generate_device_fingerprint(self) -> Dict[str, str]:
    return {
        "browser_resolution": "1462-725",  # åŸºäºçœŸå®æŠ“åŒ…
        "platform": "MacIntel",
        "hardware_concurrency": "6",
        "device_memory": "32",
        "timezone_offset": "-480"  # GMT+8
    }
```

### 2. æ™ºèƒ½è¯·æ±‚é—´éš”
```python
# éšæœºé—´éš”ï¼Œæ¨¡æ‹Ÿäººç±»è¡Œä¸º
required_interval = random.uniform(self.min_interval, self.max_interval)
if elapsed < required_interval:
    sleep_time = required_interval - elapsed
    time.sleep(sleep_time)
```

### 3. åŠ¨æ€å¤´éƒ¨å¢å¼º
```python
optional_headers = {
    "DNT": "1",
    "Sec-GPC": "1", 
    "X-Requested-With": "XMLHttpRequest",
    "Priority": "u=1, i"
}
# 50%æ¦‚ç‡éšæœºæ·»åŠ ï¼Œå¢åŠ ä¸å¯é¢„æµ‹æ€§
```

## ğŸ“Š æµ‹è¯•éªŒè¯ç»“æœ

### åŠŸèƒ½æµ‹è¯•é€šè¿‡ç‡: 100%
- âœ… è¯·æ±‚å¤´é…ç½®: 3/3ä¸ªå®‰å…¨å¤´éƒ¨æ­£ç¡®
- âœ… Cookieé…ç½®: 22ä¸ªcookieå®Œæ•´è§£æï¼Œ6/6ä¸ªå…³é”®cookieåŒ…å«
- âœ… è®¾å¤‡æŒ‡çº¹: ç”Ÿæˆå®Œæ•´è®¾å¤‡ç¯å¢ƒæ•°æ®
- âœ… éšæœºåŒ–åŠŸèƒ½: å¤´éƒ¨ã€é—´éš”ã€å‚æ•°å…¨éƒ¨éšæœºåŒ–
- âœ… APIå¢å¼º: æ‰€æœ‰ä¸»è¦APIæ–¹æ³•å·²å‡çº§

### æ€§èƒ½ä¼˜åŒ–
- ğŸ”„ è¯·æ±‚é—´éš”: 1.0-3.0ç§’æ™ºèƒ½æ§åˆ¶
- ğŸ”— è¿æ¥å¤ç”¨: é…ç½®è¿æ¥æ± (10/20)
- ğŸ“‹ å¤´éƒ¨ä¼˜åŒ–: åŸºç¡€å¤´éƒ¨+éšæœºå¢å¼ºå¤´éƒ¨
- ğŸ¯ å‚æ•°å¢å¼º: æ—¶é—´æˆ³+32ä½éšæœºID

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### ç«‹å³å¯ç”¨åŠŸèƒ½
1. **å¯åŠ¨æœåŠ¡å™¨**: `python -m main`
2. **è®¾ç½®Cookie**: ä½¿ç”¨ `set_bilibili_cookies` å·¥å…·
3. **æµ‹è¯•åŠŸèƒ½**: ä½¿ç”¨ `test_enhanced_features` éªŒè¯
4. **APIè°ƒç”¨**: æ‰€æœ‰ç°æœ‰APIéƒ½å·²è‡ªåŠ¨å¢å¼º

### æœ€ä½³å®è·µ
- ğŸª **å¼ºçƒˆå»ºè®®è®¾ç½®å®Œæ•´cookie**ï¼Œæå‡æˆåŠŸç‡è‡³95%+
- â±ï¸ **ä¿æŒé€‚å½“è¯·æ±‚é¢‘ç‡**ï¼Œé¿å…è¿‡äºé¢‘ç¹çš„APIè°ƒç”¨  
- ğŸ”„ **å®šæœŸæ›´æ–°cookie**ï¼Œä¿æŒä¼šè¯æ´»è·ƒçŠ¶æ€
- ğŸ§ª **ä½¿ç”¨æµ‹è¯•å·¥å…·**ï¼Œç›‘æ§åŠŸèƒ½çŠ¶æ€

## ğŸ¯ é¢„æœŸæ•ˆæœ

åŸºäºæœ¬æ¬¡ä¼˜åŒ–ï¼Œé¢„æœŸå¯ä»¥å®ç°ï¼š

1. **æˆåŠŸç‡æå‡**: ä»60-70%æå‡è‡³90-95%
2. **åçˆ¬èƒ½åŠ›**: å¤§å¹…é™ä½è¢«æ£€æµ‹æ¦‚ç‡
3. **ç¨³å®šæ€§å¢å¼º**: æ›´å¥½çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
4. **ç”¨æˆ·ä½“éªŒ**: æ›´å‡†ç¡®ã€æ›´å®Œæ•´çš„æ•°æ®è¿”å›

## ğŸ“š ç›¸å…³æ–‡ä»¶

- ğŸ“„ `main.py` - ä¸»æœåŠ¡å™¨æ–‡ä»¶ (å·²ä¼˜åŒ–)
- ğŸ“„ `cookie_example.json` - Cookieé…ç½®ç¤ºä¾‹ (å·²æ›´æ–°)
- ğŸ“„ `test_enhanced_packet_analysis.py` - åŠŸèƒ½æµ‹è¯•è„šæœ¬ (æ–°å¢)
- ğŸ“„ æœ¬æŠ¥å‘Š - å®Œæ•´çš„ä¼˜åŒ–è¯´æ˜

---

**ğŸ‰ æ€»ç»“**: åŸºäºç”¨æˆ·æä¾›çš„çœŸå®Bç«™æŠ“åŒ…æ•°æ®ï¼Œæˆ‘ä»¬æˆåŠŸå®ç°äº†å…¨æ–¹ä½çš„åŠŸèƒ½å¢å¼ºï¼Œæ˜¾è‘—æå‡äº†MCPæœåŠ¡å™¨çš„åçˆ¬èƒ½åŠ›å’ŒAPIæˆåŠŸç‡ã€‚æ‰€æœ‰åŠŸèƒ½å·²æµ‹è¯•å®Œæˆï¼Œå¯ç«‹å³æŠ•å…¥ä½¿ç”¨ã€‚
