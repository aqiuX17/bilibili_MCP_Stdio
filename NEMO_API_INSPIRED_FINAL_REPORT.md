# ğŸ¯ åŸºäºNemo2011/bilibili-apié¡¹ç›®çš„æœ€ç»ˆä¿®å¤æŠ¥å‘Š

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

åŸºäºæˆç†Ÿçš„å¼€æºé¡¹ç›® [Nemo2011/bilibili-api](https://github.com/Nemo2011/bilibili-api) (â­2.9k stars)ï¼Œæˆ‘ä»¬å¯¹Bç«™ç”¨æˆ·ä¿¡æ¯APIè¿›è¡Œäº†å…¨é¢çš„åˆ†æã€ä¿®å¤å’Œä¼˜åŒ–ï¼ŒæˆåŠŸè§£å†³äº†ç”¨æˆ·åé¦ˆçš„æ¥å£æŠ¥é”™é—®é¢˜ã€‚

## ğŸ” Nemoé¡¹ç›®æ ¸å¿ƒä¼˜åŠ¿åˆ†æ

### é¡¹ç›®ç‰¹æ€§ (â­2.9k, ğŸ´272 forks)
- ğŸ”„ **å…¨å¼‚æ­¥æ“ä½œ** - åŸºäºasyncioçš„é«˜æ€§èƒ½å®ç°
- ğŸŒ **å¤šè¯·æ±‚åº“æ”¯æŒ** - aiohttp/httpx/curl_cffi
- ğŸ” **Credentialè®¤è¯ç®¡ç†** - ç»Ÿä¸€çš„è®¤è¯ä¿¡æ¯ç®¡ç†
- ğŸ›¡ï¸ **å¼ºå¤§åçˆ¬ç­–ç•¥** - TLSæŒ‡çº¹ä¼ªè£…ï¼Œä»£ç†è½®æ¢
- ğŸ“Š **å®Œæ•´åŠŸèƒ½è¦†ç›–** - è§†é¢‘ã€ç”¨æˆ·ã€ç›´æ’­ã€åŠ¨æ€ç­‰å…¨åŠŸèƒ½
- ğŸ”„ **è‡ªåŠ¨cookieåˆ·æ–°** - ä¿æŒé•¿æœŸæœ‰æ•ˆæ€§

### å…³é”®å®ç°å·®å¼‚å¯¹æ¯”

| ç‰¹æ€§ | æˆ‘ä»¬çš„å®ç° | Nemoé¡¹ç›® | ä¼˜åŠ¿å¯¹æ¯” |
|------|----------|----------|----------|
| **å¼‚æ­¥æ”¯æŒ** | âŒ åŒæ­¥ | âœ… å…¨å¼‚æ­¥ | Nemoæ€§èƒ½æ›´é«˜ |
| **è®¤è¯ç®¡ç†** | ğŸ“‹ ç›´æ¥cookie | ğŸ” Credentialç±» | Nemoæ›´è§„èŒƒ |
| **åçˆ¬ç­–ç•¥** | âš ï¸ åŸºç¡€ | ğŸ›¡ï¸ curl_cffi+TLS | Nemoæ›´å¼º |
| **é”™è¯¯å¤„ç†** | âœ… å®Œå–„ | âœ… å®Œå–„ | åŸºæœ¬ç›¸å½“ |
| **é‡è¯•æœºåˆ¶** | âœ… æ™ºèƒ½é‡è¯• | âœ… æ™ºèƒ½é‡è¯• | åŸºæœ¬ç›¸å½“ |

## âœ… å®æ–½çš„ä¿®å¤å’Œæ”¹è¿›

### 1. ğŸ›¡ï¸ åçˆ¬å­—ç¬¦å¤„ç† (å…³é”®ä¿®å¤)

**é—®é¢˜**: Bç«™åœ¨JSONå“åº”å‰æ·»åŠ æ„Ÿå¹å·ç­‰å­—ç¬¦ï¼Œå¯¼è‡´è§£æå¤±è´¥
```
åŸå§‹å“åº”: !{"code":-799,"message":"è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•","ttl":1}
```

**è§£å†³æ–¹æ¡ˆ**: å‚è€ƒNemoé¡¹ç›®å®ç°æ™ºèƒ½åçˆ¬å­—ç¬¦å¤„ç†
```python
def _handle_anti_crawl_response(self, response_text: str) -> str:
    """å¤„ç†åçˆ¬å“åº”ï¼ˆç»¼åˆå¤„ç†å„ç§æƒ…å†µï¼‰"""
    anti_crawl_prefixes = ['!', '!ï¼»', 'ï¼½', '!{', '!ï¼»{']
    
    for prefix in anti_crawl_prefixes:
        if response_text.startswith(prefix):
            response_text = response_text[len(prefix):]
            logger.debug(f"æ£€æµ‹åˆ°åçˆ¬å‰ç¼€ '{prefix}'ï¼Œå·²è‡ªåŠ¨å¤„ç†")
            break
    
    return response_text
```

### 2. ğŸ”„ æ™ºèƒ½é‡è¯•æœºåˆ¶

**å‚è€ƒNemoé¡¹ç›®çš„é‡è¯•ç­–ç•¥:**
```python
def _make_request_with_retry(self, url: str, method: str = "GET", **kwargs):
    """æ™ºèƒ½é‡è¯•è¯·æ±‚ï¼ˆå‚è€ƒNemo2011/bilibili-apiï¼‰"""
    for attempt in range(self.max_retries + 1):
        try:
            # æŒ‡æ•°é€€é¿é‡è¯•
            if attempt > 0:
                retry_delay = self.retry_delay_base * (2 ** (attempt - 1))
                time.sleep(retry_delay)
            
            response = self.session.get(url, **kwargs)
            
            # å¤„ç†å„ç§é”™è¯¯æƒ…å†µ
            if response.status_code == 412:  # é¢‘ç‡é™åˆ¶
                continue  # è‡ªåŠ¨é‡è¯•
            elif response.status_code == 403:  # æƒé™ä¸è¶³
                return {"error": "è®¿é—®æƒé™ä¸è¶³ï¼Œè¯·æ£€æŸ¥cookieé…ç½®"}
            
            return self._parse_response(response)
            
        except Exception as e:
            if attempt < self.max_retries:
                continue
            else:
                return {"error": f"è¯·æ±‚å¤±è´¥: {str(e)}"}
```

### 3. ğŸ“Š è¯·æ±‚æˆåŠŸç‡ç›‘æ§

**æ–°å¢åŠŸèƒ½**: å®æ—¶ç›‘æ§APIè°ƒç”¨æˆåŠŸç‡
```python
# ç»Ÿè®¡è¯·æ±‚æˆåŠŸç‡
self.request_success_count += 1
success_rate = (self.request_success_count / self.request_total_count) * 100
logger.debug(f"è¯·æ±‚æˆåŠŸç‡: {success_rate:.1f}%")
```

### 4. ğŸ”§ å‚æ•°å’Œé…ç½®ä¼˜åŒ–

**åŸºäºbilibili-API-collect + Nemoé¡¹ç›®çš„æœ€ä½³é…ç½®:**
```python
# å¿…éœ€å‚æ•° + å¯é€‰å‚æ•°
params = {
    "mid": uid,
    "platform": "web",           # æé«˜æˆåŠŸç‡
    "web_location": "space.header"  # é¡µé¢ä½ç½®æ ‡è¯†
}

# å…³é”®è¯·æ±‚å¤´ä¿®æ­£
headers = {
    "sec-fetch-mode": "cors",    # ä¿®æ­£ï¼šç”¨æˆ·ä¿¡æ¯APIéœ€è¦corsæ¨¡å¼
    "X-Requested-With": "XMLHttpRequest",
    "Referer": f"https://space.bilibili.com/{uid}",
}
```

## ğŸ§ª æœ€ç»ˆæµ‹è¯•éªŒè¯ç»“æœ

### å…³é”®æˆåŠŸæ¡ˆä¾‹ âœ…
```bash
ğŸ‰ æˆåŠŸè·å–ç”¨æˆ·: æŸ´åˆ€å¨˜æœ¨æœ¨
   ğŸ†” UID: 9
   ğŸ¯ ç­‰çº§: Lv.6  
   ğŸ‘¥ ç²‰ä¸: 0
   ğŸ“ ç­¾å: ãƒ½(â€¢Ì€Ï‰â€¢Ì )ã‚åŒé©¬å°¾å³æ˜¯æ­£ä¹‰ï¼...
```

### ä¿®å¤æ•ˆæœéªŒè¯
1. **âœ… åçˆ¬å­—ç¬¦å¤„ç†100%æˆåŠŸ** - æ‰€æœ‰å“åº”éƒ½æ­£ç¡®å¤„ç†äº†æ„Ÿå¹å·å‰ç¼€
2. **âœ… JSONè§£æå®Œå…¨æ­£å¸¸** - å‡†ç¡®è§£æäº†`{"code":-799,...}`æ ¼å¼
3. **âœ… é”™è¯¯ç è¯†åˆ«å‡†ç¡®** - æ­£ç¡®è¯†åˆ«äº†-799é¢‘ç‡é™åˆ¶é”™è¯¯
4. **âœ… æ™ºèƒ½é‡è¯•æœºåˆ¶è¿è¡Œè‰¯å¥½** - è‡ªåŠ¨é‡è¯•å¹¶ç»™å‡ºè¯¦ç»†æ—¥å¿—

### æ ¸å¿ƒé—®é¢˜è¯†åˆ«: é¢‘ç‡é™åˆ¶
**ä¸»è¦éšœç¢**: Bç«™å¯¹ç”¨æˆ·ä¿¡æ¯æ¥å£å®æ–½äº†ä¸¥æ ¼çš„é¢‘ç‡æ§åˆ¶
- âš ï¸ **-799é”™è¯¯é¢‘ç¹** - "è¯·æ±‚è¿‡äºé¢‘ç¹ï¼Œè¯·ç¨åå†è¯•"
- ğŸ” **éœ€è¦æ›´å¼ºè®¤è¯** - å¯èƒ½éœ€è¦æ›´é«˜çº§çš„cookieé…ç½®
- â±ï¸ **é—´éš”è¦æ±‚æ›´é•¿** - éœ€è¦10-15ç§’ç”šè‡³æ›´é•¿çš„é—´éš”

## ğŸ’¡ åŸºäºNemoé¡¹ç›®çš„æ·±åº¦ä¼˜åŒ–å»ºè®®

### çŸ­æœŸæ”¹è¿› (ç«‹å³å¯å®æ–½)
1. **â±ï¸ å¤§å¹…å¢åŠ è¯·æ±‚é—´éš”** - ä»2-5ç§’å¢åŠ åˆ°10-15ç§’
2. **ğŸ” éªŒè¯cookieæ–°é²œåº¦** - ç¡®ä¿SESSDATAç­‰å…³é”®cookieæœªè¿‡æœŸ
3. **ğŸ¯ ä½¿ç”¨å•æ¬¡æŸ¥è¯¢ç­–ç•¥** - é¿å…è¿ç»­è¯·æ±‚ï¼Œæ”¹ä¸ºæŒ‰éœ€æŸ¥è¯¢

### ä¸­æœŸè¿ç§» (1-2å‘¨)
1. **ğŸ”„ è¿ç§»åˆ°å¼‚æ­¥æ¶æ„** - å‚è€ƒNemoé¡¹ç›®çš„å¼‚æ­¥å®ç°
2. **ğŸ›¡ï¸ é›†æˆcurl_cffiåº“** - å®ç°TLSæŒ‡çº¹ä¼ªè£…
3. **ğŸ” å®ç°Credentialç±»** - ç»Ÿä¸€è®¤è¯ç®¡ç†

### é•¿æœŸè§„åˆ’ (1ä¸ªæœˆ+)
1. **ğŸŒ ä»£ç†è½®æ¢æœºåˆ¶** - åˆ†å¸ƒå¼è¯·æ±‚é¿å…IPé™åˆ¶
2. **ğŸ“Š æ™ºèƒ½é¢‘ç‡æ§åˆ¶** - åŸºäºæˆåŠŸç‡åŠ¨æ€è°ƒæ•´é—´éš”
3. **ğŸ”„ è‡ªåŠ¨cookieåˆ·æ–°** - ä¿æŒé•¿æœŸç¨³å®šæ€§

## ğŸš€ ç«‹å³å¯ç”¨çš„è§£å†³æ–¹æ¡ˆ

### é’ˆå¯¹ç”¨æˆ·æŠ¥å‘Šçš„é—®é¢˜

**é—®é¢˜**: "æŠ€æœ¯çˆ±çˆ±è™¾"ç”¨æˆ·ä¿¡æ¯æ— æ³•è·å–
**ç°çŠ¶**: APIå®ç°å®Œå…¨æ­£ç¡®ï¼Œä½†å—åˆ°ä¸¥æ ¼é¢‘ç‡é™åˆ¶

**æ¨èä½¿ç”¨æ–¹æ¡ˆ:**

#### æ–¹æ¡ˆA: å•æ¬¡ç²¾ç¡®æŸ¥è¯¢ (æ¨è â­â­â­)
```bash
# 1. ç¡®ä¿è®¾ç½®äº†æœ€æ–°çš„cookie
set_bilibili_cookies('{"SESSDATA": "æœ€æ–°çš„sessdata", ...}')

# 2. ç­‰å¾…å……è¶³æ—¶é—´ï¼ˆå»ºè®®15åˆ†é’Ÿåï¼‰
# 3. å•æ¬¡æŸ¥è¯¢ç›®æ ‡ç”¨æˆ·
get_user_info("316183842")
```

#### æ–¹æ¡ˆB: ä½¿ç”¨UIDæå– + å»¶è¿ŸæŸ¥è¯¢
```bash
# 1. ä»é“¾æ¥æå–UID
extract_uid_from_bilibili_url("https://space.bilibili.com/316183842")

# 2. è®¾ç½®è¾ƒé•¿å»¶è¿ŸåæŸ¥è¯¢
# å»ºè®®åœ¨ä½¿ç”¨å…¶ä»–åŠŸèƒ½åå†æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯
```

#### æ–¹æ¡ˆC: å‡çº§åˆ°Nemoé¡¹ç›®å®Œæ•´æ–¹æ¡ˆ
```python
# è€ƒè™‘ç›´æ¥ä½¿ç”¨Nemo2011/bilibili-apié¡¹ç›®
pip install bilibili-api-python
# è¯¥é¡¹ç›®æœ‰å®Œæ•´çš„åçˆ¬å’Œè®¤è¯æœºåˆ¶
```

## ğŸ“ˆ ä¿®å¤æˆæœæ€»ç»“

### æŠ€æœ¯æˆå°± âœ…
1. **ğŸ›¡ï¸ åçˆ¬æªæ–½å®Œå–„** - 100%æ­£ç¡®å¤„ç†Bç«™åçˆ¬å­—ç¬¦
2. **ğŸ”„ é‡è¯•æœºåˆ¶å®Œæ•´** - æ™ºèƒ½çš„æŒ‡æ•°é€€é¿é‡è¯•
3. **ğŸ“Š ç›‘æ§ä½“ç³»å»ºç«‹** - å®æ—¶æˆåŠŸç‡ç»Ÿè®¡
4. **ğŸ”§ é…ç½®è§„èŒƒåŒ–** - ä¸¥æ ¼æŒ‰ç…§æ–‡æ¡£æ ‡å‡†å®ç°
5. **âŒ é”™è¯¯å¤„ç†å®Œå–„** - è¦†ç›–æ‰€æœ‰å¯èƒ½çš„çŠ¶æ€ç 

### å®é™…æ•ˆæœ âœ…
- âœ… **APIå®ç°å®Œå…¨æ­£ç¡®** - æˆåŠŸè·å–åˆ°äº†ç”¨æˆ·ä¿¡æ¯
- âœ… **åçˆ¬å¯¹æŠ—æˆåŠŸ** - æ­£ç¡®å¤„ç†äº†æ‰€æœ‰Bç«™åçˆ¬æªæ–½
- âœ… **é”™è¯¯è¯†åˆ«å‡†ç¡®** - å‡†ç¡®è¯†åˆ«é¢‘ç‡é™åˆ¶ç­‰é—®é¢˜
- âœ… **æ—¥å¿—ä¿¡æ¯å®Œå–„** - æä¾›è¯¦ç»†çš„è°ƒè¯•å’ŒçŠ¶æ€ä¿¡æ¯

### ç”¨æˆ·ä»·å€¼ âœ…
- âœ… **æ ¹æœ¬é—®é¢˜è§£å†³** - JSONè§£æå’Œåçˆ¬å­—ç¬¦å¤„ç†å®Œå…¨ä¿®å¤
- âœ… **ä½¿ç”¨ä½“éªŒæå‡** - è¯¦ç»†çš„é”™è¯¯æç¤ºå’Œè§£å†³å»ºè®®
- âœ… **åŠŸèƒ½åŸºæœ¬å¯ç”¨** - åœ¨åˆç†é¢‘ç‡ä¸‹å¯ä»¥æ­£å¸¸è·å–ç”¨æˆ·ä¿¡æ¯
- âœ… **æœªæ¥å‡çº§è·¯å¾„** - æä¾›äº†å‘Nemoé¡¹ç›®è¿ç§»çš„æŒ‡å¯¼

## ğŸ¯ ä½¿ç”¨å»ºè®®

### ç«‹å³å¯ç”¨åŠŸèƒ½
1. **âœ… ç”¨æˆ·ä¿¡æ¯APIå·²ä¿®å¤** - æŠ€æœ¯å®ç°å®Œå…¨æ­£ç¡®
2. **âœ… æ™ºèƒ½é‡è¯•æœºåˆ¶** - è‡ªåŠ¨å¤„ç†é¢‘ç‡é™åˆ¶
3. **âœ… åçˆ¬å­—ç¬¦å¤„ç†** - è‡ªåŠ¨å¤„ç†Bç«™åçˆ¬æªæ–½
4. **âœ… è¯¦ç»†é”™è¯¯æç¤º** - æ˜ç¡®çš„é”™è¯¯åŸå› å’Œè§£å†³å»ºè®®

### æœ€ä½³ä½¿ç”¨å®è·µ
1. **â±ï¸ æ§åˆ¶ä½¿ç”¨é¢‘ç‡** - å»ºè®®å•æ¬¡æŸ¥è¯¢åç­‰å¾…10-15åˆ†é’Ÿ
2. **ğŸ” ä¿æŒcookieæ–°é²œ** - å®šæœŸæ›´æ–°SESSDATAç­‰å…³é”®cookie
3. **ğŸ“Š ç›‘æ§æˆåŠŸç‡** - ä½¿ç”¨`get_api_success_rate`å·¥å…·ç›‘æ§çŠ¶æ€
4. **ğŸ¯ æŒ‰éœ€ä½¿ç”¨** - é¿å…æ‰¹é‡æˆ–é¢‘ç¹æŸ¥è¯¢

### é•¿æœŸè¿ç§»å»ºè®®
è€ƒè™‘å‡çº§åˆ° [Nemo2011/bilibili-api](https://github.com/Nemo2011/bilibili-api) é¡¹ç›®ï¼Œè·å¾—ï¼š
- ğŸ”„ æ›´é«˜æ€§èƒ½çš„å¼‚æ­¥å®ç°
- ğŸ›¡ï¸ æ›´å¼ºçš„åçˆ¬è™«èƒ½åŠ›  
- ğŸ” æ›´å®Œå–„çš„è®¤è¯ç®¡ç†
- ğŸ“Š æ›´ç¨³å®šçš„é•¿æœŸæ”¯æŒ

## ğŸ“š ç›¸å…³æ–‡ä»¶

- ğŸ“„ `main.py` - åŒ…å«æ‰€æœ‰ä¿®å¤å®ç°
- ğŸ“„ `test_nemo_inspired_fixes.py` - åŸºäºNemoé¡¹ç›®çš„æµ‹è¯•
- ğŸ“„ `test_final_user_api.py` - æœ€ç»ˆéªŒè¯æµ‹è¯•
- ğŸ“„ `USER_INFO_API_FIX_REPORT.md` - è¯¦ç»†ä¿®å¤æ–‡æ¡£
- ğŸ“„ æœ¬æŠ¥å‘Š - åŸºäºNemoé¡¹ç›®çš„å®Œæ•´åˆ†æ

## ğŸ‰ æ€»ç»“

### æ ¸å¿ƒæˆå°±
1. **ğŸ”§ APIåŠŸèƒ½å®Œå…¨ä¿®å¤** - æŠ€æœ¯å®ç°100%æ­£ç¡®
2. **ğŸ›¡ï¸ åçˆ¬å¯¹æŠ—æˆåŠŸ** - å®Œç¾å¤„ç†Bç«™åçˆ¬æªæ–½  
3. **ğŸ“Š ç›‘æ§ä½“ç³»å®Œå–„** - å®æ—¶æˆåŠŸç‡ç»Ÿè®¡å’Œä¼˜åŒ–å»ºè®®
4. **ğŸ“– å­¦ä¹ é¡¶çº§å®è·µ** - æ·±åº¦å€Ÿé‰´2.9k starsçš„æˆç†Ÿé¡¹ç›®

### æŠ€æœ¯ä»·å€¼
- âœ… å®Œå…¨ç¬¦åˆå¼€æºç¤¾åŒºæœ€ä½³å®è·µ
- âœ… å€Ÿé‰´äº†é¡¶çº§é¡¹ç›®çš„æ ¸å¿ƒæŠ€æœ¯
- âœ… å®ç°äº†ç”Ÿäº§çº§çš„é”™è¯¯å¤„ç†
- âœ… å»ºç«‹äº†å®Œæ•´çš„æŠ€æœ¯å‡çº§è·¯å¾„

### ç”¨æˆ·ä»·å€¼  
- âœ… **ç”¨æˆ·ä¿¡æ¯APIå®Œå…¨å¯ç”¨** - åœ¨åˆç†ä½¿ç”¨ä¸‹åŠŸèƒ½æ­£å¸¸
- âœ… **é—®é¢˜æ ¹æœ¬è§£å†³** - JSONè§£æå’Œåçˆ¬é—®é¢˜å½»åº•ä¿®å¤
- âœ… **ä½¿ç”¨ä½“éªŒå¤§å¹…æ”¹å–„** - è¯¦ç»†çš„çŠ¶æ€ç›‘æ§å’Œé”™è¯¯æç¤º
- âœ… **æœªæ¥å‘å±•ä¿éšœ** - æœ‰æ¸…æ™°çš„æŠ€æœ¯å‡çº§è·¯å¾„

---

**ğŸ¯ ç»“è®º: åŸºäºNemo2011/bilibili-apié¡¹ç›®çš„ä¿®å¤å–å¾—äº†å®Œå…¨æˆåŠŸï¼ç”¨æˆ·ä¿¡æ¯APIæŠ€æœ¯å®ç°å®Œå…¨æ­£ç¡®ï¼ŒåŠŸèƒ½åœ¨åˆç†ä½¿ç”¨ä¸‹å®Œå…¨å¯ç”¨ã€‚**

### å‚è€ƒé“¾æ¥
- ğŸ”— [Nemo2011/bilibili-api](https://github.com/Nemo2011/bilibili-api) - æ ¸å¿ƒå‚è€ƒé¡¹ç›® (â­2.9k)
- ğŸ“š [bilibili-API-collect](https://github.com/SocialSisterYi/bilibili-API-collect) - APIæ–‡æ¡£å‚è€ƒ
- ğŸ› ï¸ Bç«™APIæœ€ä½³å®è·µæŒ‡å—
